= Dakota & IPS Parameter Study Example =
Please contact Marc Durant at Tech-X Corp with any questions or problems
mdurant@txcorp.com

The scripts in this directory allow running parameter studies on IPS using Dakota.
They have been written to minimize the amount of file editing necessary to run a
simple parameter study on the model components.  At the moment the scripts are 
written to use model_epa_input.nml to give IPS initial conditions.  However, Tech-X
will be working on a more complex system to allow parameter studies on the real
components using cdf files for input.

= One-Time Configuration steps =
1) Open dakota_wrapper.sh and confirm that the definitions of the following paths are correct:
   IPS_ROOT - must point to the root directory of your IPS install
              on quartic.txcorp.com this is /contrib/ips
   DAKOTA_ROOT - must point to the root directory of your Dakota install
                 on quartic.txcorp.com this is /contrib/dakota

= Quick-Start =
   If you want to get up and running quickly you may use the supplied configuration files
   for IPS and DAKOTA.  However, you may run into problems with paths defined in the 
   IPS config, in which case you will need to do some tweaking to run properly.
   For a quick start, execute the following command:
       ./dakota_wrapper.sh model_sim.config dakota_ips.in

= To Run Your Own Parameter Study With These Scripts =
1) Working IPS config file
   You must have a working IPS config file that will allow you to perform a single run
   against the model components.  An example config file is included in this directory
   as model_sim.config.  If you have a different config file you'd like to use,
   simply pass your file name to the dakota_wrapper script (step 5).

2) Appropriate Initial Values in model_epa_input.nml
   This parameter study example uses the model_epa namelist file to supply values
   to IPS.  Therefore, you will need to have a copy of that namelist file that contains
   the values you would like to use for the IPS run.  Do not worry about your 
   independent variables in this step, just leave them defined in the namelist file.
   At the moment, the name of this file is hard-coded into the scripts, so you must
   OVERWRITE this file with your own if there are differences.

3) Dakota Configuration File dakota_ips.in
   You will need to edit the dakota configuration file to specify what kind of parameter
   study to run.  The example dakota configuration file in this directory is set up to
   perform a single-variable parameter study on the variable 'ne0'.  This variable name
   MUST match the name of a variable in the namelist file.  The dakota script also 
   specifies a start value, an end value, and a number of steps.  Dakota offers a huge
   number of options, but only a few are necessary for running a simple parameter study.
   Note: the value "file_tag" MUST remain in the 'interface' section for proper execution.

4) Execute the Top-Level Dakota Script
   Run the script "dakota_wrapper.sh" with the following two arguments:
     -name of IPS config file
     -name of Dakota config file
   For example, using the provided config files gives the following command:
      ./dakota_wrapper.sh model_sim.config dakota_ips.in

= Results =
If all goes well, Dakota will perform the requested number of evaluations of IPS.  When
finished there will be a working directory named "parameter_study" in the current directory.
Inside this directory you will find the following files:
  -dakota_tabular.dat
       A tab-separated list of the output value from IPS.  At the moment this is a dummy file
       If there is a specific output value you would like to have placed in this file, contact
       Marc Durant for a customized script and instructions.
  -dakota_error.txt
       Any messages directed to standard error during the run
  -dakota_output.txt
       Any messages directed to standard output during the run
  -A copy of your original dakota config file (for record keeping)
  -A number of directories named RUN_1, RUN_2, etc
       These directories are the working directories for each run of IPS.  They contain
       the ips config file, model_epa namelist, and any data generated by this run of IPS.

At the moment there is no file containing the aggregate results from all runs.  In order to
examine the output you will need to look at the plasma state files available in each RUN
directory at parameter_study/RUN_#/simulation_results/history/plasma_state.
